# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —Å—ä—ë–º–∫–∞—Ö

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ MAX (WhatsApp/SMS) –¥–ª—è:
- **–ö–ª–∏–µ–Ω—Ç–æ–≤** ‚Äî –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ —Å –¥–∞—Ç–æ–π —Å—ä—ë–º–∫–∏
- **–§–æ—Ç–æ–≥—Ä–∞—Ñ–∞** ‚Äî –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞ 24 —á–∞—Å–∞ –∏ –∑–∞ 1 —á–∞—Å –¥–æ —Å—ä—ë–º–∫–∏

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. Backend —Ñ—É–Ω–∫—Ü–∏–∏

#### `shooting-notifications`
**URL:** `https://functions.poehali.dev/b2bd6fbd-f4a9-4bec-b6b7-0689b79375ae`

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.

**–ó–∞–ø—Ä–æ—Å:**
```json
POST /
Headers: X-User-Id: <photographer_id>
Body: {
  "project_id": 123,
  "client_id": 456,
  "notify_client": true,
  "notify_photographer": true
}
```

**–ß—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É:**
```
üì∏ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å—ä—ë–º–∫–∏

üé¨ –ü—Ä–æ–µ–∫—Ç: –°–≤–∞–¥–µ–±–Ω–∞—è —Å—ä—ë–º–∫–∞
üìÖ –î–∞—Ç–∞: 15 —è–Ω–≤–∞—Ä—è 2025
üïê –í—Ä–µ–º—è: 14:00
üìç –ê–¥—Ä–µ—Å: —É–ª. –ü—É—à–∫–∏–Ω–∞, –¥. 10

üë§ –§–æ—Ç–æ–≥—Ä–∞—Ñ: –ï–ª–µ–Ω–∞ –ü–æ–Ω–æ–º–∞—Ä–µ–≤–∞
üìû –¢–µ–ª–µ—Ñ–æ–Ω: +7 (999) 123-45-67

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å—ä—ë–º–∫—É, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–æ–º.

–î–æ –≤—Å—Ç—Ä–µ—á–∏! üé•
```

**–ß—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—É:**
```
üì∏ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ —Å—ä—ë–º–∫–µ

üé¨ –ü—Ä–æ–µ–∫—Ç: –°–≤–∞–¥–µ–±–Ω–∞—è —Å—ä—ë–º–∫–∞
üìÖ –î–∞—Ç–∞: 15 —è–Ω–≤–∞—Ä—è 2025
üïê –í—Ä–µ–º—è: 14:00
‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 2 —á
üìç –ê–¥—Ä–µ—Å: —É–ª. –ü—É—à–∫–∏–Ω–∞, –¥. 10

üë§ –ö–ª–∏–µ–Ω—Ç: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤
üìû –¢–µ–ª–µ—Ñ–æ–Ω: +7 (999) 987-65-43
üìß Email: ivan@example.com

–ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –≤—ã–µ–∑–¥–æ–º! üì∑
```

---

#### `shooting-reminders-cron`
**URL:** `https://functions.poehali.dev/de28f751-d390-4a12-9abd-23d70a40b40c`

–ö—Ä–æ–Ω-–∑–∞–¥–∞—á–∞, –∫–æ—Ç–æ—Ä–∞—è –∫–∞–∂–¥—ã–π —á–∞—Å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ —Å—ä—ë–º–∫–∏ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∞–º:
- **–ó–∞ 24 —á–∞—Å–∞** –¥–æ —Å—ä—ë–º–∫–∏
- **–ó–∞ 1 —á–∞—Å** –¥–æ —Å—ä—ë–º–∫–∏

**–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** —á–µ—Ä–µ–∑ Yandex Cloud Functions Triggers (–∫–∞–∂–¥—ã–π —á–∞—Å).

**–£—Å–ª–æ–≤–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏:**
- –£ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω (`phone_verified = TRUE`)
- –í –ø—Ä–æ–µ–∫—Ç–µ —É–∫–∞–∑–∞–Ω–∞ –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å—ä—ë–º–∫–∏
- –í—Ä–µ–º—è –¥–æ —Å—ä—ë–º–∫–∏ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –æ–∫–Ω–æ:
  - 23-25 —á–∞—Å–æ–≤ (–¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞ 24—á)
  - 0.75-1.25 —á–∞—Å–∞ (–¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∑–∞ 1—á)

---

### 2. Frontend –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**–§–∞–π–ª:** `src/components/clients/dialog/NotificationService.ts`

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –≤ `ProjectHandlers.tsx`:

```typescript
await sendProjectNotification(localClient, project, photographerName);
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –®–∞–≥ 1: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —É —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω —Ç–µ–ª–µ—Ñ–æ–Ω

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∞–∫–∫–∞—É–Ω—Ç–∞ (`/webapp/settings`) –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∫–∞–∑–∞–Ω –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞.

–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ë–î:
```sql
SELECT id, phone, phone_verified FROM t_p28211681_photo_secure_web.users;
```

---

### –®–∞–≥ 2: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ MAX credentials –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

–°–µ–∫—Ä–µ—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- `MAX_INSTANCE_ID` ‚Äî Instance ID –æ—Ç GREEN-API
- `MAX_TOKEN` ‚Äî Token –æ—Ç GREEN-API

---

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –∫—Ä–æ–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–í Yandex Cloud —Å–æ–∑–¥–∞–π—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ `shooting-reminders-cron`:
- –¢–∏–ø: Timer
- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: `0 * * * *` (–∫–∞–∂–¥—ã–π —á–∞—Å)
- –í—ã–∑–æ–≤: `https://functions.poehali.dev/de28f751-d390-4a12-9abd-23d70a40b40c`

---

## –†–∞–±–æ—Ç–∞ —Å–∏—Å—Ç–µ–º—ã

### –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞

1. –§–æ—Ç–æ–≥—Ä–∞—Ñ —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ–µ–∫—Ç —Å –¥–∞—Ç–æ–π –∏ –≤—Ä–µ–º–µ–Ω–µ–º —Å—ä—ë–º–∫–∏
2. –°–∏—Å—Ç–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–µ–∫—Ç –≤ –ë–î —á–µ—Ä–µ–∑ `clients` API
3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `sendProjectNotification()`:
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ä–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `shooting-notifications` API
4. –§—É–Ω–∫—Ü–∏—è `shooting-notifications`:
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∫–ª–∏–µ–Ω—Ç–∞
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∞ –∏–∑ –ë–î
   - –§–æ—Ä–º–∏—Ä—É–µ—Ç 2 —Å–æ–æ–±—â–µ–Ω–∏—è (–¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∞)
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —á–µ—Ä–µ–∑ GREEN-API

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

–ö–∞–∂–¥—ã–π —á–∞—Å –∫—Ä–æ–Ω-–∑–∞–¥–∞—á–∞:
1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–æ–≤ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–º–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞–º–∏
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –ø—Ä–æ–µ–∫—Ç—ã —á–µ—Ä–µ–∑ `clients` API
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Ä–µ–º—è –¥–æ —Å—ä—ë–º–∫–∏
4. –ï—Å–ª–∏ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –æ–∫–Ω–æ (24—á –∏–ª–∏ 1—á) ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ

---

## –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
```bash
# –õ–æ–≥–∏ —Ñ—É–Ω–∫—Ü–∏–∏ shooting-notifications
curl https://functions.poehali.dev/b2bd6fbd-f4a9-4bec-b6b7-0689b79375ae
```

### –í—Ä—É—á–Ω—É—é –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫—Ä–æ–Ω-–∑–∞–¥–∞—á—É
```bash
curl https://functions.poehali.dev/de28f751-d390-4a12-9abd-23d70a40b40c
```

–û—Ç–≤–µ—Ç:
```json
{
  "success": true,
  "timestamp": "2025-12-25T20:00:00",
  "results": {
    "checked": 15,
    "sent_24h": 2,
    "sent_1h": 1,
    "errors": 0
  }
}
```

---

## –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∞:**
   ```sql
   SELECT phone, phone_verified FROM t_p28211681_photo_secure_web.users WHERE id = 18;
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ MAX credentials:**
   - `MAX_INSTANCE_ID` –∏ `MAX_TOKEN` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Å–µ–∫—Ä–µ—Ç–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞:**
   - –î–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `+7` –∏–ª–∏ `8`
   - –ú–∏–Ω–∏–º—É–º 10 —Ü–∏—Ñ—Ä

### –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä–µ–º—è —Å—ä—ë–º–∫–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ:**
   - –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω—ã `startDate` –∏ `shooting_time`

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∫—Ä–æ–Ω-–∑–∞–¥–∞—á–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:**
   - –í—Ä—É—á–Ω—É—é –≤—ã–∑–æ–≤–∏—Ç–µ URL —Ñ—É–Ω–∫—Ü–∏–∏ `shooting-reminders-cron`
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Yandex Cloud

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–∞–Ω–Ω—ã–º

### –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –≤ –ø—Ä–æ–µ–∫—Ç–µ:**
- `startDate` ‚Äî –¥–∞—Ç–∞ —Å—ä—ë–º–∫–∏ (ISO —Ñ–æ—Ä–º–∞—Ç)
- `shooting_time` ‚Äî –≤—Ä–µ–º—è —Å—ä—ë–º–∫–∏ (HH:MM)
- `name` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è —É –∫–ª–∏–µ–Ω—Ç–∞:**
- `phone` ‚Äî –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (—Ñ–æ—Ä–º–∞—Ç: +7XXXXXXXXXX)
- `name` ‚Äî –∏–º—è –∫–ª–∏–µ–Ω—Ç–∞

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è —É —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∞:**
- `phone` ‚Äî –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (—Ñ–æ—Ä–º–∞—Ç: +7XXXXXXXXXX)
- `phone_verified = TRUE` ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω
- `display_name` –∏–ª–∏ `email` ‚Äî –¥–ª—è –∏–º–µ–Ω–∏ –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–∏

---

## API Endpoints

| –§—É–Ω–∫—Ü–∏—è | URL | –ú–µ—Ç–æ–¥ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| `shooting-notifications` | `https://functions.poehali.dev/b2bd6fbd-f4a9-4bec-b6b7-0689b79375ae` | POST | –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ |
| `shooting-reminders-cron` | `https://functions.poehali.dev/de28f751-d390-4a12-9abd-23d70a40b40c` | GET | –ö—Ä–æ–Ω-–∑–∞–¥–∞—á–∞ –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π |
| `max` | `https://functions.poehali.dev/6bd5e47e-49f9-4af3-a814-d426f5cd1f6d` | POST | –°—Ç–∞—Ä—ã–π API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å) |
