# ๐ธ ะะทะฒะปะตัะตะฝะธะต ะธ ะพัะพะฑัะฐะถะตะฝะธะต EXIF ะดะฐะฝะฝัั

## โ ะงัะพ ัะดะตะปะฐะฝะพ

### 1. **Backend ััะฝะบัะธั ะดะปั ะธะทะฒะปะตัะตะฝะธั EXIF** 
`backend/extract-exif/index.py`

**URL:** `https://functions.poehali.dev/340b5361-292f-4f16-8d31-f179fa6856b1`

**ะคัะฝะบัะธะพะฝะฐะป:**
- โ ะะทะฒะปะตัะตะฝะธะต EXIF ะดะฐะฝะฝัั ะธะท ัะพัะพ ะฒ S3
- โ ะะพะดะดะตัะถะบะฐ JPEG, PNG, TIFF ัะพัะผะฐัะพะฒ
- โ ะะทะฒะปะตัะตะฝะธะต GPS ะดะฐะฝะฝัั
- โ ะะฐััะธะฝะณ ะดะฐัั ัััะผะบะธ ะฒ ISO ัะพัะผะฐั
- โ ะะฟัะตะดะตะปะตะฝะธะต ัะฐะทะผะตัะพะฒ ะธ ัะพัะผะฐัะฐ ะธะทะพะฑัะฐะถะตะฝะธั
- โ ะะฑัะฐะฑะพัะบะฐ ััััั (raw) EXIF ัะตะณะพะฒ

**ะะธะฑะปะธะพัะตะบะธ:**
- `Pillow (PIL)` - ะดะปั ัะฐะฑะพัั ั ะธะทะพะฑัะฐะถะตะฝะธัะผะธ
- `boto3` - ะดะปั ะดะพัััะฟะฐ ะบ S3

---

### 2. **ะะพะผะฟะพะฝะตะฝั ะฟัะพัะผะพััะฐ EXIF ะดะฐะฝะฝัั**
`src/components/photobank/PhotoExifDialog.tsx`

**ะัะฐัะธะฒะพะต ะพัะพะฑัะฐะถะตะฝะธะต:**
- ๐ท **ะัะฝะพะฒะฝะฐั ะธะฝัะพัะผะฐัะธั:**
  - ะะฐะผะตัะฐ (Make + Model)
  - ะะฑัะตะบัะธะฒ (LensModel)
  - ะะฐัะฐ ัััะผะบะธ (ัะพัะผะฐัะธัะพะฒะฐะฝะฐ)
  - ะะฐะทัะตัะตะฝะธะต (ImageWidth ร ImageHeight)
  - ะคะพัะผะฐั ัะฐะนะปะฐ

- โ๏ธ **ะะฐัะฐะผะตััั ัััะผะบะธ:**
  - ะัะดะตัะถะบะฐ (1/250s, 1/1000s ะธ ั.ะด.)
  - ะะธะฐััะฐะณะผะฐ (f/2.8, f/5.6 ะธ ั.ะด.)
  - ISO (ISO 100, ISO 3200 ะธ ั.ะด.)
  - ะคะพะบััะฝะพะต ัะฐัััะพัะฝะธะต (24mm, 50mm ะธ ั.ะด.)

- โน๏ธ **ะะพะฟะพะปะฝะธัะตะปัะฝะฐั ะธะฝัะพัะผะฐัะธั:**
  - ะัะฟััะบะฐ (ััะฐะฑะพัะฐะปะฐ/ะฝะตั)
  - ะะฐะปะฐะฝั ะฑะตะปะพะณะพ (ะฐะฒัะพ/ัััะฝะพะน)
  - ะัะพะณัะฐะผะผะฝะพะต ะพะฑะตัะฟะตัะตะฝะธะต

**ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต:**
- โ ะัะพะฑะฝัะต ะทะฝะฐัะตะฝะธั ะฟัะตะพะฑัะฐะทััััั ะฒ ัะธัะฐะตะผัะน ัะพัะผะฐั
- โ ะะฐัั ะพัะพะฑัะฐะถะฐัััั ะฟะพ-ััััะบะธ
- โ ะะบะพะฝะบะธ ะดะปั ะบะฐะถะดะพะน ะบะฐัะตะณะพัะธะธ
- โ ะะดะฐะฟัะธะฒะฝัะน ะดะธะทะฐะนะฝ ะดะปั ะผะพะฑะธะปัะฝัั

---

### 3. **ะะฝัะตะณัะฐัะธั ะฒ ัะพัะพ ะฑะฐะฝะบ**

**ะะดะต ะดะพัััะฟะฝะพ:**
- โ ะะฝะพะฟะบะฐ "Info" ะฒ ะฟัะพัะผะพัััะธะบะต ัะพัะพ (PhotoGridViewer)
- โ ะัะบััะฒะฐะตััั ะฟะพะฒะตัั ะฟัะพัะผะพััะฐ ัะพัะพ
- โ ะะพะบะฐะทัะฒะฐะตั ะฟัะตะฒัั ัะพัะพ + ะฒัะต EXIF ะดะฐะฝะฝัะต
- โ ะะฐะฑะพัะฐะตั ะฝะฐ ะฒัะตั ััััะพะนััะฒะฐั

---

## ๐จ UI/UX ะดะธะทะฐะนะฝ

### ะะธะฐะปะพะณ EXIF
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ธ ะะฝัะพัะผะฐัะธั ะพ ัะพัะพ           [X] โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ [ะัะตะฒัั ัะพัะพ]                       โ
โ                                     โ
โ ๐ท ะะฐะผะตัะฐ                           โ
โ    Canon EOS 5D Mark IV             โ
โ                                     โ
โ ๐ ะะฑัะตะบัะธะฒ                         โ
โ    Canon EF 24-70mm f/2.8L II USM   โ
โ                                     โ
โ ๐ ะะฐัะฐ ัััะผะบะธ                      โ
โ    31 ะดะตะบะฐะฑัั 2025 ะณ., 14:30        โ
โ                                     โ
โ ๐ ะะฐะทัะตัะตะฝะธะต                       โ
โ    6720 ร 4480  [JPEG]              โ
โ                                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ โ๏ธ ะะฐัะฐะผะตััั ัััะผะบะธ                 โ
โ                                     โ
โ ะัะดะตัะถะบะฐ      1/250s                โ
โ ะะธะฐััะฐะณะผะฐ     f/2.8                 โ
โ ISO           ISO 400               โ
โ ะคะพะบััะฝะพะต      50mm                  โ
โ                                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ โน๏ธ ะะพะฟะพะปะฝะธัะตะปัะฝะพ                    โ
โ                                     โ
โ ะัะฟััะบะฐ:       ะะตะท ะฒัะฟััะบะธ          โ
โ ะะฐะปะฐะฝั ะฑะตะปะพะณะพ: ะะฒัะพ                 โ
โ ะะ:            Adobe Lightroom      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ะะพะดะดะตัะถะธะฒะฐะตะผัะต EXIF ัะตะณะธ

### ะัะฝะพะฒะฝัะต ัะตะณะธ
| ะขะตะณ | ะะฟะธัะฐะฝะธะต | ะัะธะผะตั |
|-----|----------|--------|
| Make | ะัะพะธะทะฒะพะดะธัะตะปั ะบะฐะผะตัั | Canon, Nikon, Sony |
| Model | ะะพะดะตะปั ะบะฐะผะตัั | EOS 5D Mark IV |
| LensModel | ะะพะดะตะปั ะพะฑัะตะบัะธะฒะฐ | EF 24-70mm f/2.8L |
| DateTime | ะะฐัะฐ ะธะทะผะตะฝะตะฝะธั | 2025:12:31 14:30:00 |
| DateTimeOriginal | ะะฐัะฐ ัััะผะบะธ | 2025:12:31 14:30:00 |
| ExposureTime | ะัะดะตัะถะบะฐ | 1/250 |
| FNumber | ะะธะฐััะฐะณะผะฐ | 28/10 (f/2.8) |
| ISOSpeedRatings | ISO | 400 |
| FocalLength | ะคะพะบััะฝะพะต ัะฐัััะพัะฝะธะต | 50/1 (50mm) |
| Flash | ะัะฟััะบะฐ | 0 (ะฝะตั), 1 (ะดะฐ) |
| WhiteBalance | ะะฐะปะฐะฝั ะฑะตะปะพะณะพ | 0 (ะฐะฒัะพ), 1 (ัััะฝะพะน) |
| Software | ะะ ะพะฑัะฐะฑะพัะบะธ | Adobe Lightroom |
| Orientation | ะัะธะตะฝัะฐัะธั | 1 (normal) |

### ะะพะฟะพะปะฝะธัะตะปัะฝัะต ัะตะณะธ
- **GPS ะดะฐะฝะฝัะต:** GPSLatitude, GPSLongitude, GPSAltitude
- **ะะฐะทะผะตัั:** ImageWidth, ImageHeight
- **ะคะพัะผะฐั:** Format (JPEG, PNG, TIFF)
- **ะฆะฒะตัะพะฒะพะต ะฟัะพัััะฐะฝััะฒะพ:** ColorSpace
- **ะะตะถะธะผ ัััะผะบะธ:** ExposureMode, MeteringMode

---

## ๐ Workflow

```
1. ะะพะปัะทะพะฒะฐัะตะปั ะพัะบััะฒะฐะตั ัะพัะพ ะฒ PhotoGridViewer
2. ะะฐะถะธะผะฐะตั ะบะฝะพะฟะบั "โน๏ธ Info"
3. ะัะบััะฒะฐะตััั PhotoExifDialog
4. ะคัะพะฝัะตะฝะด ะทะฐะฟัะฐัะธะฒะฐะตั EXIF ัะตัะตะท backend API
5. Backend ัะบะฐัะธะฒะฐะตั ัะพัะพ ะธะท S3
6. Pillow ะธะทะฒะปะตะบะฐะตั EXIF ะดะฐะฝะฝัะต
7. ะะฐะฝะฝัะต ัะพัะผะฐัะธัััััั ะธ ะพัะฟัะฐะฒะปััััั ััะพะฝัะตะฝะดั
8. UI ะบัะฐัะธะฒะพ ะพัะพะฑัะฐะถะฐะตั ะฒัะต ะฟะฐัะฐะผะตััั
```

---

## ๐ฏ API ะญะฝะดะฟะพะธะฝั

**URL:** `https://functions.poehali.dev/340b5361-292f-4f16-8d31-f179fa6856b1`

### ะะฐะฟัะพั
```http
POST /extract-exif
Content-Type: application/json

{
  "s3_key": "uploads/12/1735648200000_abc123.jpg"
}
```

### ะัะฒะตั (ััะฟะตั)
```json
{
  "success": true,
  "s3_key": "uploads/12/1735648200000_abc123.jpg",
  "exif": {
    "Make": "Canon",
    "Model": "Canon EOS 5D Mark IV",
    "LensModel": "EF 24-70mm f/2.8L II USM",
    "DateTime": "2025-12-31T14:30:00",
    "DateTimeOriginal": "2025-12-31T14:30:00",
    "ExposureTime": "1/250",
    "FNumber": "28/10",
    "ISOSpeedRatings": "400",
    "FocalLength": "50/1",
    "Flash": "0",
    "WhiteBalance": "0",
    "ImageWidth": 6720,
    "ImageHeight": 4480,
    "Format": "JPEG",
    "Software": "Adobe Lightroom Classic 12.5"
  },
  "file_size": 8456320
}
```

### ะัะฒะตั (ะพัะธะฑะบะฐ)
```json
{
  "error": "An error occurred (NoSuchKey) when calling the GetObject operation: The specified key does not exist."
}
```

---

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะขะตัั ะฒ ะบะพะฝัะพะปะธ
```bash
# ะะทะฒะปะตัั EXIF ะธะท ัะตะฐะปัะฝะพะณะพ ัะฐะนะปะฐ
curl -X POST https://functions.poehali.dev/340b5361-292f-4f16-8d31-f179fa6856b1 \
  -H "Content-Type: application/json" \
  -d '{"s3_key": "uploads/12/1735648200000_abc123.jpg"}'
```

### ะัะพะฒะตัะบะฐ ะฒ UI
1. ะัะบัะพะนัะต ะคะพัะพ ะฑะฐะฝะบ
2. ะัะบัะพะนัะต ะปัะฑะพะต ัะพัะพ
3. ะะฐะถะผะธัะต ะบะฝะพะฟะบั "โน๏ธ" ะฒ ะฟัะฐะฒะพะผ ะฒะตััะฝะตะผ ัะณะปั
4. ะะพะปะถะตะฝ ะพัะบัััััั ะดะธะฐะปะพะณ ั EXIF ะดะฐะฝะฝัะผะธ

---

## ๐ ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั

- **ะัะตะผั ะธะทะฒะปะตัะตะฝะธั EXIF:** ~500-1000ms (ะทะฐะฒะธัะธั ะพั ัะฐะทะผะตัะฐ ัะฐะนะปะฐ)
- **ะะฐะทะผะตั ะพัะฒะตัะฐ:** ~1-5KB (JSON ั EXIF ะดะฐะฝะฝัะผะธ)
- **ะััะธัะพะฒะฐะฝะธะต:** Frontend ะบััะธััะตั ัะตะทัะปััะฐั ะฝะฐ ะฒัะตะผั ะฟัะพัะผะพััะฐ
- **ะะฟัะธะผะธะทะฐัะธั:** Pillow ัะธัะฐะตั ัะพะปัะบะพ ะผะตัะฐะดะฐะฝะฝัะต, ะฝะต ะดะตะบะพะดะธััะตั ะฒัั ะธะทะพะฑัะฐะถะตะฝะธะต

---

## ๐ ะะตะทัะปััะฐั

ะขะตะฟะตัั ัะพัะพะณัะฐัั ะผะพะณัั:
1. โ **ะะธะดะตัั ะฟะพะปะฝัั ะธะฝัะพัะผะฐัะธั ะพ ัะพัะพ** - ะบะฐะผะตัะฐ, ะพะฑัะตะบัะธะฒ, ะฝะฐัััะพะนะบะธ
2. โ **ะัะพะฒะตัััั ะฟะฐัะฐะผะตััั ัััะผะบะธ** - ะฒัะดะตัะถะบะฐ, ะดะธะฐััะฐะณะผะฐ, ISO
3. โ **ะะฝะฐะปะธะทะธัะพะฒะฐัั ะดะฐัั ัััะผะบะธ** - ะดะปั ะณััะฟะฟะธัะพะฒะบะธ ะธ ะพัะณะฐะฝะธะทะฐัะธะธ
4. โ **ะัะฐัะธะฒะพ ะพัะพะฑัะฐะถัะฝะฝัะต ะดะฐะฝะฝัะต** - ัะดะพะฑะฝัะน UI ั ะธะบะพะฝะบะฐะผะธ

### ะกะปะตะดัััะธะต ัะฐะณะธ (ะพะฟัะธะพะฝะฐะปัะฝะพ):
- [ ] ะะฒัะพะผะฐัะธัะตัะบะฐั ะณััะฟะฟะธัะพะฒะบะฐ ัะพัะพ ะฟะพ ะดะฐัะต ัััะผะบะธ
- [ ] ะคะธะปัััะฐัะธั ะฟะพ ะบะฐะผะตัะต/ะพะฑัะตะบัะธะฒั
- [ ] ะัะพะฑัะฐะถะตะฝะธะต GPS ะฝะฐ ะบะฐััะต
- [ ] ะญะบัะฟะพัั EXIF ะฒ CSV
- [ ] ะะตะดะฐะบัะธัะพะฒะฐะฝะธะต ะผะตัะฐะดะฐะฝะฝัั
